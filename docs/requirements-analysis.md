# 计客超级密码机游戏APP需求分析文档

## 1. 项目概述

### 1.1 项目背景

本项目旨在开发一款基于计客®超级密码机玩具的 HarmonyOS 游戏应用。计客超级密码机是一款密码破译主题益智游戏，其核心玩法基于经典的 Mastermind（珠玑妙算）桌游规则。

### 1.2 产品定位

- **目标平台**: HarmonyOS (鸿蒙系统)
- **目标用户**: 5岁以上儿童及成人
- **产品类型**: 益智逻辑推理游戏
- **核心价值**: 锻炼逻辑推理能力、培养专注力、提升问题分解能力

### 1.3 参考产品

计客®超级密码机实体玩具，官方网站: https://www.giiker.cn/

---

## 2. 核心游戏规则

### 2.1 基本规则（Mastermind 珠玑妙算）

游戏的核心是**密码破译**：

1. **密码组成**: 由4个颜色槽位组成的密码序列
2. **可用颜色**: 基础版本包含4-6种颜色（如红、黄、绿、蓝、紫、橙）
3. **猜测机会**: 玩家有**7次**猜测机会来破译正确的密码
4. **目标**: 在限定次数内猜出颜色和位置都正确的密码组合

### 2.2 反馈提示系统

每次猜测后，系统提供反馈提示：

| 提示类型 | 颜色标识 | 含义 |
|---------|---------|------|
| 猜中 (Hit) | 绿色/黑色 | 颜色正确 **且** 位置正确 |
| 伪猜中 (Pseudo-hit) | 白色 | 颜色正确 **但** 位置错误 |
| 未猜中 | 黑色/无 | 颜色和位置都错误 |

**重要规则**:
- 每个密码颜色只能匹配一次
- 猜中的结果不计入伪猜中
- 如果密码中有2个红色，猜测中有3个红色，最多只能得到2个提示

### 2.3 提示模式

#### 2.3.1 初级模式（一一对应）
- 提示与槽位**一一对应**
- 绿色提示出现在第N位，表示第N位猜对了
- 适合初学者直观理解规则

#### 2.3.2 高级模式（不对应）
- 提示**不与槽位对应**
- 只显示猜中和伪猜中的数量，不指明具体位置
- 需要更高的逻辑推理能力

### 2.4 游戏示例

**密码**: 🔴🟢🔵🟡 (红绿蓝黄)

| 猜测 | 结果 | 解释 |
|-----|------|-----|
| 🟢🟢🔴🔴 | 1猜中, 1伪猜中 | 第2位绿色正确；红色存在但位置错 |
| 🔴🔵🔵🟡 | 2猜中, 1伪猜中 | 第1位红、第4位黄正确；蓝色位置错 |
| 🔴🟢🔵🟡 | 4猜中, 0伪猜中 | **破译成功！** |

---

## 3. 功能需求

### 3.1 游戏模式

#### 3.1.1 单人闯关模式

| 难度 | 关卡数 | 提示模式 | 颜色数量 | 特点 |
|-----|-------|---------|---------|-----|
| 初级 | 100关 | 一一对应 | 4种颜色 | 适合入门学习 |
| 高级 | 500关 | 不对应 | 4-6种颜色 | 挑战逻辑极限 |

**关卡进度系统**:
- 关卡解锁机制（需通过前一关）
- 星级评价（根据使用次数评定1-3星）
- 关卡进度保存与同步

#### 3.1.2 双人对战模式

**玩法流程**:
1. 玩家A（出题者）设置4位密码
2. 玩家A设置挑战时间限制（可选）
3. 玩家B（破译者）在限定时间/次数内破译
4. 角色互换，进行下一轮
5. 统计双方用时/次数，判定胜负

**对战选项**:
- 本地双人（同一设备轮流）
- 在线对战（未来扩展）

#### 3.1.3 自由练习模式

- 无关卡限制的自由练习
- 可自定义难度参数
- 用于熟悉规则和测试策略

### 3.2 提示辅助系统

实现**双重提示功能**，从具象到抽象帮助玩家学习：

#### 3.2.1 第一重提示（具象）
- 直接标记某个位置的颜色状态
- 消耗1次提示机会
- 适合初学者

#### 3.2.2 第二重提示（抽象）
- 给出逻辑推理的思路引导
- 如："某两个颜色需要交换位置"
- 不直接给出答案

### 3.3 用户界面需求

#### 3.3.1 主界面
```
┌────────────────────────────┐
│         密码破译机          │
│     [天线动画/信号图标]      │
├────────────────────────────┤
│   ┌──────────────────┐     │
│   │   单人闯关       │     │
│   └──────────────────┘     │
│   ┌──────────────────┐     │
│   │   双人对战       │     │
│   └──────────────────┘     │
│   ┌──────────────────┐     │
│   │   自由练习       │     │
│   └──────────────────┘     │
│   ┌──────────────────┐     │
│   │   设置          │     │
│   └──────────────────┘     │
└────────────────────────────┘
```

#### 3.3.2 游戏界面
```
┌────────────────────────────┐
│ 关卡: 15    剩余次数: 5/7   │
├────────────────────────────┤
│      [密码显示区域]         │
│     ■ ■ ■ ■ (隐藏)        │
├────────────────────────────┤
│   猜测历史记录:             │
│   ① 🔴🟢🔵🟡 → ⚫⚪⚪    │
│   ② 🟣🔴🟢🔵 → ⚫⚫      │
│   ③ ...                   │
├────────────────────────────┤
│   当前猜测:                 │
│   [🔴][🟢][🔵][🟡]        │
├────────────────────────────┤
│ [颜色选择器: 🔴🟡🟢🔵🟣🟠] │
├────────────────────────────┤
│  [提示]  [确认]  [重置]    │
└────────────────────────────┘
```

#### 3.3.3 颜色方案

| 用途 | 颜色 | 色值建议 |
|-----|------|---------|
| 红色 | 🔴 | #E53935 |
| 黄色 | 🟡 | #FDD835 |
| 绿色 | 🟢 | #43A047 |
| 蓝色 | 🔵 | #1E88E5 |
| 紫色 | 🟣 | #8E24AA |
| 橙色 | 🟠 | #FB8C00 |
| 猜中提示 | ⚫ | #212121 |
| 伪猜中提示 | ⚪ | #FAFAFA |

### 3.4 音效系统

| 场景 | 音效类型 | 描述 |
|-----|---------|-----|
| 开机/启动 | 摩斯电码音效 | 模拟接收神秘信号 |
| 选择颜色 | 点击反馈音 | 清脆的选择音 |
| 提交猜测 | 验证音效 | 类似密码锁验证声 |
| 猜中提示 | 正确音效 | 积极的反馈音 |
| 破译成功 | 胜利音效 | 欢快的成功音乐 |
| 破译失败 | 失败音效 | 温和的失败提示 |
| 提示使用 | 信号接收音 | 天线信号效果 |

**静音功能**: 支持一键静音

### 3.5 动画效果

| 场景 | 动画效果 |
|-----|---------|
| 启动界面 | 天线拉出动画 + 信号灯闪烁 |
| 颜色选择 | 颜色球弹跳/缩放反馈 |
| 提交猜测 | 验证进度条动画 |
| 提示显示 | 提示灯依次点亮 |
| 关卡完成 | 星星飞入 + 庆祝特效 |
| 关卡解锁 | 锁打开动画 |

---

## 4. 数据需求

### 4.1 关卡数据结构

```typescript
interface Level {
  id: number;                    // 关卡ID
  difficulty: 'easy' | 'hard';   // 难度
  password: Color[];             // 正确密码 (4位)
  colorCount: number;            // 可用颜色数量 (4-6)
  hintMode: 'mapped' | 'unmapped'; // 提示模式
  maxAttempts: number;           // 最大尝试次数 (默认7)
}

type Color = 'red' | 'yellow' | 'green' | 'blue' | 'purple' | 'orange';
```

### 4.2 游戏记录数据

```typescript
interface GameRecord {
  odeLevelId: number;              // 关卡ID
  attempts: Attempt[];           // 猜测记录
  result: 'success' | 'fail';    // 结果
  stars: 1 | 2 | 3;              // 星级评价
  timeSpent: number;             // 用时(秒)
  hintsUsed: number;             // 使用提示次数
  timestamp: number;             // 时间戳
}

interface Attempt {
  guess: Color[];                // 猜测序列
  hits: number;                  // 猜中数
  pseudoHits: number;            // 伪猜中数
}
```

### 4.3 用户数据

```typescript
interface UserProgress {
  easyProgress: number;          // 初级关卡进度 (1-100)
  hardProgress: number;          // 高级关卡进度 (1-500)
  totalStars: number;            // 总星数
  gamesPlayed: number;           // 游戏总局数
  successRate: number;           // 成功率
  bestStreak: number;            // 最佳连胜
  achievements: Achievement[];   // 成就列表
}
```

### 4.4 本地存储

使用 HarmonyOS Preferences API 存储:
- 用户设置（音效开关、主题等）
- 游戏进度
- 历史记录
- 成就数据

---

## 5. 算法需求

### 5.1 密码验证算法

```typescript
function evaluateGuess(password: Color[], guess: Color[]): { hits: number, pseudoHits: number } {
  let hits = 0;
  let pseudoHits = 0;

  const passwordCopy = [...password];
  const guessCopy = [...guess];

  // 第一遍: 统计猜中 (位置和颜色都正确)
  for (let i = 0; i < 4; i++) {
    if (guessCopy[i] === passwordCopy[i]) {
      hits++;
      passwordCopy[i] = null;  // 标记已匹配
      guessCopy[i] = null;
    }
  }

  // 第二遍: 统计伪猜中 (颜色正确但位置错误)
  for (let i = 0; i < 4; i++) {
    if (guessCopy[i] !== null) {
      const index = passwordCopy.indexOf(guessCopy[i]);
      if (index !== -1) {
        pseudoHits++;
        passwordCopy[index] = null;  // 标记已匹配
      }
    }
  }

  return { hits, pseudoHits };
}
```

### 5.2 关卡生成算法

```typescript
function generatePassword(colorCount: number): Color[] {
  const colors: Color[] = ['red', 'yellow', 'green', 'blue', 'purple', 'orange']
    .slice(0, colorCount);

  const password: Color[] = [];
  for (let i = 0; i < 4; i++) {
    const randomIndex = Math.floor(Math.random() * colors.length);
    password.push(colors[randomIndex]);
  }

  return password;
}
```

### 5.3 星级评定算法

```typescript
function calculateStars(attempts: number, maxAttempts: number, hintsUsed: number): 1 | 2 | 3 {
  const attemptsRatio = attempts / maxAttempts;

  if (hintsUsed > 0) {
    return 1;  // 使用提示最多1星
  } else if (attemptsRatio <= 0.5) {
    return 3;  // 使用不超过一半次数得3星
  } else if (attemptsRatio <= 0.75) {
    return 2;  // 使用不超过3/4次数得2星
  } else {
    return 1;  // 其他情况得1星
  }
}
```

---

## 6. 非功能需求

### 6.1 性能要求

| 指标 | 要求 |
|-----|-----|
| 启动时间 | < 2秒 |
| 页面切换 | < 300ms |
| 动画帧率 | ≥ 60fps |
| 内存占用 | < 100MB |

### 6.2 兼容性要求

- HarmonyOS 3.0 及以上版本
- 适配手机屏幕尺寸 (5.0" - 7.0")
- 支持横屏和竖屏模式
- 支持深色模式

### 6.3 可访问性要求

- 颜色对比度符合 WCAG 2.1 AA 标准
- 支持色盲模式（使用图形区分颜色）
- 按钮点击区域 ≥ 44x44 dp
- 支持屏幕阅读器

### 6.4 国际化要求

- 支持简体中文、繁体中文、英文
- 文本资源外部化
- 日期时间本地化

---

## 7. 扩展功能（未来版本）

### 7.1 在线功能
- 在线对战匹配
- 全球排行榜
- 每日挑战
- 好友系统

### 7.2 社交功能
- 分享游戏成绩
- 邀请好友对战
- 成就系统

### 7.3 高级模式
- 5位/6位密码（更高难度）
- 限时模式
- 无限模式（自动生成关卡）
- 竞速模式

### 7.4 教学功能
- 新手引导教程
- 策略提示教学
- 逻辑推理技巧讲解

---

## 8. 项目里程碑

| 阶段 | 主要内容 |
|-----|---------|
| MVP | 基础游戏机制 + 初级单人模式(50关) + 基本UI |
| V1.0 | 完整单人模式(600关) + 双人本地对战 + 音效系统 |
| V1.5 | 成就系统 + 数据统计 + UI优化 |
| V2.0 | 在线功能 + 社交分享 + 高级模式 |

---

## 9. 参考资料

- [GiiKER 计客官网](https://www.giiker.cn/)
- [珠玑妙算游戏规则 - CSDN](https://blog.csdn.net/weixin_46970264/article/details/132457233)
- [Mastermind 珠玑妙算 - BoardGameGeek](https://boardgamegeek.com/thread/3284707/mastermind-zhu-ji-miao-suan-chinese-review)
- [什么值得买 - 计客产品评测](https://wiki.smzdm.com/p/yd8793e/)
- [计客产品介绍 - 值值值](https://www.zhizhizhi.com/n/bikp5)

---

*文档版本: 1.0*
*创建日期: 2026-01-27*
*最后更新: 2026-01-27*
